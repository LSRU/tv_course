<!DOCTYPE html>
<html>
<head>
  <title>Data plotting</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Data plotting',
                        subtitle: 'ggplot2',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                        favIcon: 'lecture06_plotting_files/logo.png',
              },

      // Author information
      presenters: [
            {
        name:  'A. Ginolhac, E. Koncina, R. Krause' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }
  </style>


  <link href="site_libs/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>
  <link href="site_libs/iosp-0.1/css/iosp.css" rel="stylesheet" />
  <script src="site_libs/iosp-0.1/js/lang-r.js"></script>
  <style type="text/css">
  
    .bg-orange {
      background-color: #FF8C00;
    }
  
    .box.bg-orange {
      border: 2px solid #804600;
      color: #000;
    }
  
    .box.bg-orange > h3:first-child {
      background-color: #804600;
      color: #fff;
    }
  
    .bg-slate {
      background-color: #7A67EE;
    }
  
    .box.bg-slate {
      border: 2px solid #3D3477;
      color: #fff;
    }
  
    .box.bg-slate > h3:first-child {
      background-color: #3D3477;
      color: #fff;
    }
  
    .bg-yellow {
      background-color: #FFFF00;
    }
  
    .box.bg-yellow {
      border: 2px solid #EEC900;
      color: #000;
    }
  
    .box.bg-yellow > h3:first-child {
      background-color: #EEC900;
      color: #000;
    }
  
    .bg-yellow2 {
      background-color: #FFEC8B;
    }
  
    .box.bg-yellow2 {
      border: 2px solid #EEB422;
      color: #000;
    }
  
    .box.bg-yellow2 > h3:first-child {
      background-color: #EEB422;
      color: #000;
    }
  
    .bg-grgold {
      background-color: #008B45;
    }
  
    .box.bg-grgold {
      border: 2px solid #004622;
      color: #fff;
    }
  
    .box.bg-grgold > h3:first-child {
      background-color: #004622;
      color: #FFD700;
    }
  </style>

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="lecture06_plotting_files/logo.png"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">3 May 2017</p>
          </hgroup>
  </slide>

<slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>ggplot2</h2></hgroup><article  id="ggplot2" class="smaller ">

<img src='img/06_ggplot2_overview.jpg' title='fig:'/>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Before, there was <code>ggplot1</code></h2></hgroup><article  id="before-there-was-ggplot1" class="smaller ">

<p>Released in <strong>2005</strong> until <strong>2008</strong> by <a href='https://github.com/hadley/ggplot1' title=''>Hadley Wickham</a>.</p>

<blockquote>
<p>If the pipe ( %&gt;% in 2014) had been invented before, <code>ggplot2</code> would have never existed <cite> Hadley Wickham</p></cite>
</blockquote>

<div class = 'row build'><div class = 'box col-6 bg-yellow '><h3>Original syntax</h3>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'># devtools::install_github(&quot;hadley/ggplot1&quot;)
p &lt;- ggplot(mtcars, list(x = mpg, y = wt)) %&gt;% 
scbrewer(ggpoint(p, list(colour = gear)))</pre></div>

</div><div class = 'box col-6 bg-yellow2 '><h3>with the pipe</h3>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'># devtools::install_github(&quot;hadley/ggplot1&quot;)
library(ggplot1)
mtcars %&gt;% 
  ggplot(list(x = mpg, y = wt)) %&gt;% 
  ggpoint(list(colour = gear)) %&gt;% 
  scbrewer()</pre></div>

<style type="text/css">
.bg-green2 > h3:first-child > a:hover {
  color: white !important;
}
</style>

</div></div><div class = 'row build'><div class = 'box col-8 offset-1 bg-grgold  stretch'><h3><a href='my%20link' title=''>ggplot2</a></h3>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>library(ggplot2)
mtcars %&gt;% 
  ggplot(aes(x = mpg, y = wt)) + 
  geom_point(aes(colour = as.factor(gear))) +
  scale_color_brewer(&quot;gear&quot;, type = &quot;qual&quot;)</pre></div>

</div><div class = 'box col-3 bg-red  stretch'><h3>Issue</h3>

<p>Introduced a break in the workflow from <code>%&gt;%</code> to <code>+</code></p>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>What is <code>ggplot2</code> </h2><h3> released in 2007</h3></hgroup><article  id="what-is-ggplot2-released-in-2007" class="smaller vs2">

<ul>
<li><code>ggplot2</code> stands for <strong>g</strong>rammar of <strong>graphics</strong> plot version 2

<ul>
<li>Inspired by Leland Wilkinsons work on the <a href='https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448' title=''>grammar of graphics</a> in 2005.</li>
<li>The idea is to split a graph into layers: for example axis, curve(s), labels.</li>
</ul></li>
</ul>

<div class = 'row'><div class = 'col-8'>

<img src='img/06_graphic_objects.png' title='fig:'/>

</div><div class = 'col-4'>

<p><span class="small">
<a href='http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.07098' title=''>Wickham H. 2007. <em>J. Comp. Graph. Stat.</em> <strong>19</strong>:3â€“28</a></span></p>

<img src='http://static.thinkr.fr/ggplot-3-300x193.png' title='fig:'/>

<p><span class="small">
source: <a href='http://www.thinkr.fr/guide-survie-ggplot2-datajournalistes/' title=''>thinkR</a></span></p>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Simple example </h2><h3> Wickham 2007</h3></hgroup><article  id="simple-example-wickham-2007" class="smaller ">

<div class = 'row'><div class = 'box col-6 stretch'><h3>dataset</h3>

<table class = 'rmdtable'>
<col width="8%" />
<col width="6%" />
<col width="9%" />
<tr class="header">
<th align="left">x</th>
<th align="left">y</th>
<th align="left">shape</th>
</tr>
<tr class="odd">
<td align="left">25</td>
<td align="left">11</td>
<td align="left">circle</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">circle</td>
</tr>
<tr class="odd">
<td align="left">75</td>
<td align="left">53</td>
<td align="left">square</td>
</tr>
<tr class="even">
<td align="left">200</td>
<td align="left">300</td>
<td align="left">square</td>
</tr>
</table>

</div><div class = 'box col-6'><h3>3 layers combined</h3>

<img src='img/06_simple_plot.png' title='fig:'/>

</div></div><div class = 'row build'><div class = 'box col-8 offset-2 bg-grgold '><h3>Faceting (treillis / latticing)</h3>

<p>What is we want to split <em>circles</em> and <em>squares</em>?</p>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Faceting </h2><h3> Wickham 2007</h3></hgroup><article  id="faceting-wickham-2007" class="smaller vs1">

<div class = 'row'><div class = 'col-8 offset-2'><h3>Split by the <strong>shape</strong></h3>

<img src='img/06_simple_facet.png' title='fig:'/>

</div></div>

<div class = 'row build'><div class = 'box col-8 offset-2 bg-grgold '><h3>Redundancy</h3>

<p>Now, <strong>dot shapes</strong> and <strong>facets</strong> give the same information. Shapes could be freed for another meaningful variable</p>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>layers</h2></hgroup><article  id="layers" class="smaller vs2">

<p><img src="img/06_ggplot2_layers.jpg" width="50%" style="display: block; margin: auto;" /></p>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>for real</h2></hgroup><article  id="for-real" class="smaller ">

<div class="chunk shadow">
<div class="row">
<div class="col-6">
<pre class = 'prettyprint lang-r'>tribble(
    ~x,   ~y,    ~shape,
   25L,  11L,  &quot;circle&quot;,
    0L,   0L,  &quot;circle&quot;,
   75L,  53L,  &quot;square&quot;,
  200L, 300L,  &quot;square&quot;
  ) %&gt;%
  ggplot(aes(x = x, y = y, shape = shape)) +
  geom_point(size = 4) +
  facet_wrap(~ shape) +
  coord_cartesian() +
  theme_classic(base_size = 18)</pre></div>

<div class="col-6">
<p><img src="lecture06_plotting_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p></div></div></div>

<div class = 'row'><div class = 'box col-8 bg-yellow'><h3>Tip</h3>

<p>awesome <a href='https://rstudio.github.io/rstudioaddins/' title=''>addin</a>: <a href='https://github.com/MilesMcBain/datapasta' title=''>datapasta</a>, paste as <em>tribbles</em> (transposed <em>tibbles</em>)</p>

<p>by Miles McBrain <img src='https://pbs.twimg.com/profile_images/702995114075955200/8s0ystej_bigger.jpg' title=''/></p>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Motivation for this layered system </h2><h3> football example</h3></hgroup><article  id="motivation-for-this-layered-system-football-example" class="smaller ">

<blockquote>
<p>[Data visualisation] is not meant just to be seen but to be read, like written text - Alberto Cairo</p>
</blockquote>

<div class = 'row build'><div class = 'box col-5 bg-yellow2 '><h3>Questions</h3>

<ol>
<li>which countries have the best teams?</li>
<li>which leagues are the most/least balanced?</li>
<li>what is the &#39;quality gap&#39; between a given pair of leagues?</li>
<li>how does the nth best team in league x today compare to its predecessors?</li>
<li>how have all of the above changed over time?</li>
</ol>

</div><div class = 'box col-4 bg-green  stretch'><h3>Stat solutions</h3>

<ol>
<li>linear comparison</li>
<li>distribution of parts within the whole</li>
<li>difference in area between two curves</li>
<li>value in context</li>
<li>evolution of an already detailed pattern over time</li>
</ol>

</div><div class = 'box col-3 bg-grgold  stretch'><h3>Visual solutions</h3>

<ol>
<li><p>points</p></li>
<li><p>points on a line</p></li>
<li><p>ribbon*</p></li>
<li><p>shaded range</p></li>
<li><p>faceted plots</p></li>
</ol>

</div></div>

<p><span class="small">
source <a href='http://johnburnmurdoch.github.io/slides/r-ggplot/' title=''>John Burn-Murdoch</a> working at the Financial Times</span></p>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>1. which countries have the best teams in 2016?</h2></hgroup><article  id="which-countries-have-the-best-teams-in-2016" class="smaller ">

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>library(tidyverse)
allSeasons &lt;- read_rds(&quot;allseasons.rds&quot;)
oneSeason &lt;- allSeasons %&gt;% filter(year == 2016)</pre></div>

<div class = 'row build'><div class = 'col-12 '>

<div class="chunk shadow">
<div class="row">
<div class="col-6">
<pre class = 'prettyprint lang-r'>ggplot(oneSeason
       ,aes(x = year, y = score, colour = country)) + 
  geom_point(size = 3) +
  scale_x_discrete() +
  theme_bw()</pre></div>

<div class="col-6">
<p><img src="lecture06_plotting_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /></p></div></div></div>

</div></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Draw your first plot</h2></hgroup><article  id="draw-your-first-plot" class="smaller ">

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>library(&quot;ggplot2&quot;)
ggplot(iris) +
  geom_point(aes(x = Petal.Width, y = Petal.Length))</pre>

<p><img src="lecture06_plotting_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /></p></div>

<p><code>ggplot</code> uses a <code>data.frame</code> and builds the plot <strong>layer by layer</strong>.</p>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Geoms</h2></hgroup><article  id="geoms" class="smaller ">

<p>Geoms, or geometric objects, define the type of plot which will be drawn.</p>

<p>Examples of <code>geom</code> are:</p>

<ul>
<li><code>geom_point()</code> to draw a scatter plot</li>
<li><code>geom_boxplot()</code> to draw boxplots</li>
<li><code>geom_line()</code> to draw lines</li>
<li><code>geom_histogram()</code> to draw histograms</li>
<li><code>geom_density()</code> to draw density curves</li>
<li>Have a look at the <a href='https://www.rstudio.com/wp-content/uploads/2015/12/ggplot2-cheatsheet-2.0.pdf' title=''>cheatsheet</a> or the ggplot2 online <a href='http://docs.ggplot2.org/' title=''>documentation</a> to list more possibilities.</li>
</ul>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Mapping aesthetics</h2></hgroup><article  id="mapping-aesthetics" class="smaller ">

<p><strong>aesthetics</strong> map the variables of a <code>data.frame</code> to the variable each ggplot2 <code>geom</code> is expecting.</p>

<p>For example <code>geom_point()</code> (used to draw a scatter plot) requires the <em><strong>x</strong></em> and <em><strong>y</strong></em> coordinates for each point.</p>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width, y = Petal.Length))</pre></div>

<table class = 'rmdtable'>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</table>

</article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide><slide class=''><hgroup><h2>Mapping aesthetics</h2></hgroup><article  id="mapping-aesthetics-1" class="smaller ">

<p><strong>aesthetics</strong> map the variables of a <code>data.frame</code> to the variable each ggplot2 <code>geom</code> is expecting.</p>

<p>For example <code>geom_point()</code> (used to draw a scatter plot) requires the <em><strong>x</strong></em> and <em><strong>y</strong></em> coordinates for each point.</p>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width, y = Petal.Length))</pre>

<p><img src="lecture06_plotting_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /></p></div>

<div class="chunk shadow">
<pre class = 'prettyprint lang-r'>knitr::knit_exit()</pre></div></article><div class = "footer"><a href='https://lsru.github.io/tv_course/'>R tidyverse workshop</a></div></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<script>
  (function () {
    footers = document.getElementsByClassName('footer');
    //imgsrc = document.getElementsByClassName("gdbar")[0].getElementsByTagName('img')[0].src;
    [].slice.call(footers).forEach(function (footer) {
      footer.innerHTML = "<img src=lecture06_plotting_files/logo.png>" + footer.innerHTML; // This is the same behaviour as the standard ioslides: logo is not self-contained
      //footer.innerHTML = "<img src=\"" + imgsrc + "\">" + footer.innerHTML; // disabling to avoid binary data replication...
    });
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
